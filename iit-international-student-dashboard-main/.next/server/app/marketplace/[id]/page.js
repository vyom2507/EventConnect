(()=>{var e={};e.id=6688,e.ids=[6688],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},70910:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>d}),r(70287),r(83794),r(71227),r(35866);var a=r(23191),n=r(88716),s=r(37922),i=r.n(s),o=r(95231),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);r.d(t,l);let d=["",{children:["marketplace",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,70287)),"C:\\Users\\vyoml\\iit-international-student-dashboard-main\\app\\marketplace\\[id]\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,83794)),"C:\\Users\\vyoml\\iit-international-student-dashboard-main\\app\\marketplace\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,71227)),"C:\\Users\\vyoml\\iit-international-student-dashboard-main\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,35866,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\vyoml\\iit-international-student-dashboard-main\\app\\marketplace\\[id]\\page.tsx"],u="/marketplace/[id]/page",p={require:r,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/marketplace/[id]/page",pathname:"/marketplace/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},14590:(e,t,r)=>{Promise.resolve().then(r.bind(r,12899)),Promise.resolve().then(r.bind(r,34461)),Promise.resolve().then(r.bind(r,78903)),Promise.resolve().then(r.t.bind(r,92481,23))},59325:(e,t,r)=>{Promise.resolve().then(r.bind(r,82746))},12899:(e,t,r)=>{"use strict";r.d(t,{Sidebar:()=>x});var a=r(10326),n=r(90434),s=r(35047),i=r(41135),o=r(24319),l=r(26641),d=r(77636),c=r(59308),u=r(24061),p=r(36283),m=r(34565),f=r(85529);let h=[{label:"Dashboard",href:"/dashboard",icon:o.Z},{label:"Pre-Arrival",href:"/pre-arrival",icon:l.Z},{label:"Campus Navigation",href:"/campus-navigation",icon:d.Z},{label:"Academic Integration",href:"/academic-integration",icon:c.Z},{label:"Social Networking",href:"/social-networking",icon:u.Z},{label:"Resource Directory",href:"/resource-directory",icon:p.Z},{label:"Marketplace",href:"/marketplace",icon:m.Z},{label:"Profile",href:"/profile",icon:f.Z}];function x(){let e=(0,s.usePathname)();return(0,a.jsxs)("aside",{className:" hidden md:flex sticky top-0 h-screen w-64 flex-shrink-0 flex-col bg-black/95 shadow-2xl ",children:[(0,a.jsxs)("div",{className:"flex h-16 items-center gap-2 px-5",children:[a.jsx("div",{className:"flex h-9 w-9 items-center justify-center rounded-xl bg-gradient-to-br from-red-600 via-red-500 to-red-400 text-white shadow-lg",children:a.jsx("span",{className:"text-lg font-bold",children:"IIT"})}),(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm font-semibold tracking-tight text-slate-50",children:"IIT Intl Student Hub"}),a.jsx("p",{className:"text-xs text-slate-400",children:"Illinois Institute of Technology \xb7 Chicago"})]})]}),a.jsx("nav",{className:"mt-4 flex-1 space-y-1 overflow-y-auto px-3 pb-4",children:h.map(t=>{let r=t.icon,s=e===t.href||"/dashboard"!==t.href&&e.startsWith(t.href);return(0,a.jsxs)(n.default,{href:t.href,className:(0,i.Z)("group flex items-center gap-3 rounded-xl px-3 py-2.5 text-sm font-medium transition-all","text-slate-200 hover:bg-red-600 hover:text-white","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-red-500",s&&"bg-red-600 text-white shadow-lg shadow-red-900/40"),children:[a.jsx(r,{className:"h-4 w-4"}),a.jsx("span",{children:t.label})]},t.href)})}),a.jsx("div",{className:"border-t border-slate-800 px-4 py-3",children:a.jsx("p",{className:"text-xs text-slate-500",children:"Tip: Bookmark this dashboard to access your IIT support toolkit in one click."})})]})}},74165:(e,t,r)=>{"use strict";r.d(t,{B:()=>i,r:()=>o});var a=r(10326),n=r(17577);let s=(0,n.createContext)(void 0);function i({children:e}){let[t,r]=(0,n.useState)([]);return a.jsx(s.Provider,{value:{items:t,addToCart:e=>{r(t=>t.find(t=>t.product.id===e.id)?t.map(t=>t.product.id===e.id?{...t,quantity:t.quantity+1}:t):[...t,{product:e,quantity:1}])},removeFromCart:e=>{r(t=>t.filter(t=>t.product.id!==e))},clearCart:()=>r([])},children:e})}function o(){let e=(0,n.useContext)(s);if(!e)throw Error("useMarketplaceCart must be used within MarketplaceCartProvider");return e}},82746:(e,t,r)=>{"use strict";r.d(t,{MarketplaceCartLayoutClient:()=>s});var a=r(10326),n=r(74165);function s({children:e}){return a.jsx(n.B,{children:e})}},78903:(e,t,r)=>{"use strict";r.d(t,{PurchaseActions:()=>o});var a=r(10326),n=r(17577),s=r(35047),i=r(21021);function o({product:e}){let t=(0,s.useRouter)(),[r,o]=(0,n.useState)(null),[l,d]=(0,n.useState)(!1),[c,u]=(0,n.useState)(!1),[p,m]=(0,n.useState)(null),f=(e.paymentOptions??"").split(",").map(e=>e.trim()).filter(Boolean),h=e.owner?.id??null,x=!!h&&r?.id===h,g=async r=>{m(null),d(!0);try{let a=await fetch("/api/marketplace/purchase",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({productId:e.id,paymentMethod:r})});if(!a.ok){let e=await a.text();throw Error(e||"Failed to create order")}let n=await a.json();if("card"===r&&n.checkoutUrl){window.location.href=n.checkoutUrl;return}if(n.conversationId){t.push(`/marketplace/chat/${n.conversationId}`),t.refresh();return}t.push("/marketplace"),t.refresh()}catch(e){console.error(e),m(e.message||"Something went wrong")}finally{d(!1)}},b=async()=>{if(confirm("Are you sure you want to delete this listing?")){u(!0),m(null);try{let r=await fetch(`/api/marketplace/products/${e.id}`,{method:"DELETE"});if(!r.ok){let e=await r.text();throw Error(e||"Failed to delete listing")}t.push("/marketplace"),t.refresh()}catch(e){console.error(e),m(e.message||"Something went wrong")}finally{u(!1)}}},y=e.owner?.fullName&&e.owner.fullName.trim().length>0?e.owner.fullName:"IIT student",v=e.owner?.program||"";return(0,a.jsxs)(i.Z,{className:"bg-white/95 text-slate-900",children:[a.jsx("h2",{className:"mb-1 text-sm font-semibold",children:"Listing details"}),(0,a.jsxs)("p",{className:"text-[11px] text-slate-600",children:["Seller:"," ",a.jsx("span",{className:"font-semibold",children:y}),v&&` \xb7 ${v}`]}),p&&a.jsx("p",{className:"mt-2 rounded-lg bg-red-50 px-3 py-2 text-[11px] text-red-700 ring-1 ring-red-200",children:p}),x?(0,a.jsxs)("div",{className:"mt-3 space-y-2 text-xs",children:[a.jsx("p",{className:"text-[11px] text-slate-600",children:"You posted this listing. You can remove it once it's no longer available."}),a.jsx("button",{type:"button",onClick:b,disabled:c,className:"w-full rounded-lg bg-slate-900 px-3 py-2 text-[11px] font-semibold text-white hover:bg-black disabled:opacity-60",children:c?"Removing...":"Delete listing"})]}):e.isActive?(0,a.jsxs)("div",{className:"mt-3 space-y-2 text-xs",children:[a.jsx("p",{className:"text-[11px] text-slate-600",children:"Choose how you want to pay for this item."}),f.includes("card")&&a.jsx("button",{type:"button",onClick:()=>g("card"),disabled:l,className:"w-full rounded-lg bg-red-600 px-3 py-2 text-[11px] font-semibold text-white shadow-sm shadow-red-900/40 hover:bg-red-500 disabled:opacity-60",children:l?"Processing...":"Pay by card (demo)"}),f.includes("in_person")&&a.jsx("button",{type:"button",onClick:()=>g("in_person"),disabled:l,className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-[11px] font-semibold text-slate-800 hover:bg-slate-50 disabled:opacity-60",children:l?"Reserving...":"Reserve for in-person payment"}),a.jsx("p",{className:"mt-2 text-[10px] text-slate-500",children:"For in-person payments, you and the seller should agree on a safe, public campus location (e.g., MTCC) and confirm the item before exchanging money."})]}):a.jsx("p",{className:"mt-3 text-[11px] text-slate-500",children:"This item has already been sold or reserved."})]})}},21021:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var a=r(10326),n=r(41135);function s({children:e,className:t}){return a.jsx("div",{className:(0,n.W)("rounded-2xl border border-slate-500/90 bg-slate-200/80 p-4 shadow-lg shadow-black/40",t),children:e})}},70287:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>u});var a=r(19510),n=r(58585),s=r(17710),i=r(83493),o=r(88806),l=r(82959),d=r(66601);let c=(0,r(68570).createProxy)(String.raw`C:\Users\vyoml\iit-international-student-dashboard-main\components\marketplace\PurchaseActions.tsx#PurchaseActions`);async function u({params:e}){let t=await i._.product.findUnique({where:{id:e.id},include:{owner:!0}});t||(0,n.notFound)();let r=(t.priceCents/100).toFixed(2),u={id:t.id,title:t.title,priceCents:t.priceCents,isActive:t.isActive,paymentOptions:t.paymentOptions,owner:t.owner?{id:t.owner.id,fullName:t.owner.fullName,program:t.owner.program}:null};return(0,a.jsxs)("div",{className:"flex min-h-screen bg-slate-950 text-slate-100",children:[a.jsx(o.Y,{}),(0,a.jsxs)("div",{className:"flex min-h-screen flex-1 flex-col",children:[a.jsx(l.l,{}),a.jsx("main",{className:"flex-1 overflow-y-auto bg-slate-900 p-4 md:p-6",children:(0,a.jsxs)("div",{className:"mx-auto flex max-w-5xl flex-col gap-4 md:grid md:grid-cols-[1.4fr,1fr]",children:[a.jsx(d.Z,{className:"bg-slate-950/90 border-slate-800 text-slate-100",children:(0,a.jsxs)("div",{className:"grid gap-4 md:grid-rows-[auto,1fr]",children:[a.jsx("div",{className:"relative h-64 w-full overflow-hidden rounded-xl bg-slate-900 md:h-72",children:t.imageUrl?a.jsx(s.default,{src:t.imageUrl,alt:t.title,fill:!0,className:"object-cover"}):a.jsx("div",{className:"flex h-full w-full items-center justify-center text-sm text-slate-500",children:"No image provided"})}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[a.jsx("h1",{className:"text-lg font-semibold text-white",children:t.title}),(0,a.jsxs)("p",{className:"text-xl font-bold text-red-300",children:["$",r]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2 text-[11px] text-slate-300",children:[(0,a.jsxs)("span",{className:"rounded-full bg-slate-900 px-2 py-0.5 ring-1 ring-slate-700",children:["Category: ",t.category]}),(0,a.jsxs)("span",{className:"rounded-full bg-slate-900 px-2 py-0.5 ring-1 ring-slate-700",children:["Condition: ",t.condition]}),(0,a.jsxs)("span",{className:"rounded-full bg-slate-900 px-2 py-0.5 ring-1 ring-slate-700",children:["Campus: ",t.campus]})]}),a.jsx("p",{className:"mt-2 text-[13px] leading-relaxed text-slate-200",children:t.description})]})]})}),a.jsx(c,{product:u})]})})]})]})}},83794:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});var a=r(19510);let n=(0,r(68570).createProxy)(String.raw`C:\Users\vyoml\iit-international-student-dashboard-main\components\marketplace\MarketplaceCartLayoutClient.tsx#MarketplaceCartLayoutClient`);function s({children:e}){return a.jsx(n,{children:e})}},88806:(e,t,r)=>{"use strict";r.d(t,{Y:()=>a});let a=(0,r(68570).createProxy)(String.raw`C:\Users\vyoml\iit-international-student-dashboard-main\components\layout\Sidebar.tsx#Sidebar`)},82959:(e,t,r)=>{"use strict";r.d(t,{l:()=>a});let a=(0,r(68570).createProxy)(String.raw`C:\Users\vyoml\iit-international-student-dashboard-main\components\layout\TopNavbar.tsx#TopNavbar`)},66601:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var a=r(19510),n=r(55761);function s({children:e,className:t}){return a.jsx("div",{className:(0,n.W)("rounded-2xl border border-slate-500/90 bg-slate-200/80 p-4 shadow-lg shadow-black/40",t),children:e})}},83493:(e,t,r)=>{"use strict";r.d(t,{_:()=>n});let a=require("@prisma/client"),n=globalThis.prisma??new a.PrismaClient({log:["error","warn"]})},58585:(e,t,r)=>{"use strict";var a=r(61085);r.o(a,"notFound")&&r.d(t,{notFound:function(){return a.notFound}}),r.o(a,"redirect")&&r.d(t,{redirect:function(){return a.redirect}})},61085:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{ReadonlyURLSearchParams:function(){return i},RedirectType:function(){return a.RedirectType},notFound:function(){return n.notFound},permanentRedirect:function(){return a.permanentRedirect},redirect:function(){return a.redirect}});let a=r(83953),n=r(16399);class s extends Error{constructor(){super("Method unavailable on `ReadonlyURLSearchParams`. Read more: https://nextjs.org/docs/app/api-reference/functions/use-search-params#updating-searchparams")}}class i extends URLSearchParams{append(){throw new s}delete(){throw new s}set(){throw new s}sort(){throw new s}}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},16399:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{isNotFoundError:function(){return n},notFound:function(){return a}});let r="NEXT_NOT_FOUND";function a(){let e=Error(r);throw e.digest=r,e}function n(e){return"object"==typeof e&&null!==e&&"digest"in e&&e.digest===r}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},8586:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"RedirectStatusCode",{enumerable:!0,get:function(){return r}}),function(e){e[e.SeeOther=303]="SeeOther",e[e.TemporaryRedirect=307]="TemporaryRedirect",e[e.PermanentRedirect=308]="PermanentRedirect"}(r||(r={})),("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},83953:(e,t,r)=>{"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{RedirectType:function(){return a},getRedirectError:function(){return l},getRedirectStatusCodeFromError:function(){return f},getRedirectTypeFromError:function(){return m},getURLFromRedirectError:function(){return p},isRedirectError:function(){return u},permanentRedirect:function(){return c},redirect:function(){return d}});let n=r(54580),s=r(72934),i=r(8586),o="NEXT_REDIRECT";function l(e,t,r){void 0===r&&(r=i.RedirectStatusCode.TemporaryRedirect);let a=Error(o);a.digest=o+";"+t+";"+e+";"+r+";";let s=n.requestAsyncStorage.getStore();return s&&(a.mutableCookies=s.mutableCookies),a}function d(e,t){void 0===t&&(t="replace");let r=s.actionAsyncStorage.getStore();throw l(e,t,(null==r?void 0:r.isAction)?i.RedirectStatusCode.SeeOther:i.RedirectStatusCode.TemporaryRedirect)}function c(e,t){void 0===t&&(t="replace");let r=s.actionAsyncStorage.getStore();throw l(e,t,(null==r?void 0:r.isAction)?i.RedirectStatusCode.SeeOther:i.RedirectStatusCode.PermanentRedirect)}function u(e){if("object"!=typeof e||null===e||!("digest"in e)||"string"!=typeof e.digest)return!1;let[t,r,a,n]=e.digest.split(";",4),s=Number(n);return t===o&&("replace"===r||"push"===r)&&"string"==typeof a&&!isNaN(s)&&s in i.RedirectStatusCode}function p(e){return u(e)?e.digest.split(";",3)[2]:null}function m(e){if(!u(e))throw Error("Not a redirect error");return e.digest.split(";",2)[1]}function f(e){if(!u(e))throw Error("Not a redirect error");return Number(e.digest.split(";",4)[3])}(function(e){e.push="push",e.replace="replace"})(a||(a={})),("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[9276,7261,9404,285,7788,3836],()=>r(70910));module.exports=a})();