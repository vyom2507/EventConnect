(()=>{var e={};e.id=8750,e.ids=[8750],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},74368:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>d}),r(9149),r(83794),r(71227),r(35866);var n=r(23191),a=r(88716),s=r(37922),i=r.n(s),o=r(95231),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);r.d(t,l);let d=["",{children:["marketplace",{children:["chat",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,9149)),"C:\\Users\\vyoml\\iit-international-student-dashboard-main\\app\\marketplace\\chat\\[id]\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,83794)),"C:\\Users\\vyoml\\iit-international-student-dashboard-main\\app\\marketplace\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,71227)),"C:\\Users\\vyoml\\iit-international-student-dashboard-main\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,35866,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\vyoml\\iit-international-student-dashboard-main\\app\\marketplace\\chat\\[id]\\page.tsx"],u="/marketplace/chat/[id]/page",p={require:r,loadChunk:()=>Promise.resolve()},m=new n.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/marketplace/chat/[id]/page",pathname:"/marketplace/chat/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},40637:(e,t,r)=>{Promise.resolve().then(r.bind(r,29618)),Promise.resolve().then(r.bind(r,88967))},59325:(e,t,r)=>{Promise.resolve().then(r.bind(r,82746))},56234:(e,t,r)=>{Promise.resolve().then(r.bind(r,10703))},34830:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,12994,23)),Promise.resolve().then(r.t.bind(r,96114,23)),Promise.resolve().then(r.t.bind(r,9727,23)),Promise.resolve().then(r.t.bind(r,79671,23)),Promise.resolve().then(r.t.bind(r,41868,23)),Promise.resolve().then(r.t.bind(r,84759,23))},29618:(e,t,r)=>{"use strict";r.d(t,{IStudentsChatWidget:()=>l});var n=r(10326),a=r(17577),s=r(94019),i=r(39730),o=r(41135);function l(){let[e,t]=(0,a.useState)(!1),[r,l]=(0,a.useState)([{id:"welcome",role:"assistant",content:"Hi, I’m iStudents Assistant \uD83D\uDC4B\n\nI can help you with pre-arrival prep, housing, campus navigation, academics, and settling into life at IIT in Chicago. What are you thinking about right now?"}]),[d,c]=(0,a.useState)(""),[u,p]=(0,a.useState)(!1),[m,f]=(0,a.useState)(null),h=(0,a.useRef)(null),x=async e=>{e.preventDefault(),f(null);let t=d.trim();if(!t||u)return;let n={id:`user-${Date.now()}`,role:"user",content:t};l(e=>[...e,n]),c(""),p(!0);try{let e=[{role:"system",content:"User is an international student at IIT."},...r.map(e=>({role:e.role,content:e.content})),{role:"user",content:t}],n=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:e})});if(!n.ok){let e=await n.json().catch(()=>({}));throw Error(e.error||"Chat request failed.")}let a=await n.json(),s="string"==typeof a.reply?a.reply:"Sorry, I couldn’t generate a response right now.",i={id:`assistant-${Date.now()}`,role:"assistant",content:s};l(e=>[...e,i])}catch(e){console.error(e),f(e.message||"Something went wrong.")}finally{p(!1)}};return(0,n.jsxs)(n.Fragment,{children:[n.jsx("button",{onClick:()=>t(e=>!e),className:"fixed bottom-4 right-4 z-40 flex h-12 w-12 items-center justify-center rounded-full bg-red-600 text-white shadow-lg shadow-red-900/60 ring-2 ring-red-300 hover:bg-red-500 md:bottom-6 md:right-6",children:e?n.jsx(s.Z,{className:"h-5 w-5"}):n.jsx(i.Z,{className:"h-5 w-5"})}),n.jsx("div",{className:(0,o.Z)("fixed bottom-20 right-4 z-40 w-[90vw] max-w-sm translate-y-4 opacity-0 transition-all duration-200 md:bottom-24 md:right-6",e&&"translate-y-0 opacity-100"),children:(0,n.jsxs)("div",{className:"flex h-80 flex-col overflow-hidden rounded-2xl bg-slate-950/95 ring-1 ring-slate-800 shadow-2xl shadow-black/80 backdrop-blur",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between bg-gradient-to-r from-red-700 to-red-600 px-3 py-2",children:[(0,n.jsxs)("div",{className:"flex flex-col",children:[n.jsx("span",{className:"text-xs font-semibold text-red-50",children:"iStudents Assistant"}),n.jsx("span",{className:"text-[10px] text-red-100/80",children:"International onboarding \xb7 IIT Chicago"})]}),n.jsx("button",{onClick:()=>t(!1),className:"rounded-full bg-white/15 p-1 text-red-50 hover:bg-white/25",children:n.jsx(s.Z,{className:"h-3 w-3"})})]}),(0,n.jsxs)("div",{className:"flex-1 space-y-2 overflow-y-auto p-3 text-[11px] text-slate-50",children:[r.map(e=>n.jsx("div",{className:(0,o.Z)("flex","user"===e.role?"justify-end":"justify-start"),children:n.jsx("div",{className:(0,o.Z)("max-w-[80%] whitespace-pre-wrap rounded-xl px-3 py-2","user"===e.role?"bg-red-600 text-white":"bg-slate-900 text-slate-100"),children:e.content})},e.id)),u&&n.jsx("div",{className:"flex justify-start",children:n.jsx("div",{className:"rounded-xl bg-slate-900 px-3 py-2 text-[11px] text-slate-300",children:"Typing…"})}),m&&(0,n.jsxs)("div",{className:"text-[10px] text-red-300",children:["Error: ",m]}),n.jsx("div",{ref:h})]}),n.jsx("form",{onSubmit:x,className:"border-t border-slate-800 bg-slate-950/90 px-3 py-2",children:(0,n.jsxs)("div",{className:"flex items-end gap-2",children:[n.jsx("textarea",{rows:1,value:d,onChange:e=>c(e.target.value),placeholder:"Ask about visas, housing, academics, or campus life…",className:"flex-1 resize-none rounded-lg border border-slate-700 bg-slate-950 px-2 py-1.5 text-[11px] text-slate-50 outline-none focus:border-red-500"}),n.jsx("button",{type:"submit",disabled:u||!d.trim(),className:"rounded-lg bg-red-600 px-3 py-1.5 text-[11px] font-semibold text-white shadow-sm shadow-red-900/40 hover:bg-red-500 disabled:cursor-not-allowed disabled:bg-red-900",children:"Send"})]})})]})})]})}},88967:(e,t,r)=>{"use strict";r.d(t,{I18nProvider:()=>o});var n=r(10326),a=r(17577);let s={en:{"nav.dashboard":"Dashboard","nav.preArrival":"Pre-Arrival","nav.campusNavigation":"Campus Navigation","nav.academicIntegration":"Academic Integration","nav.socialNetworking":"Social Networking","nav.resourceDirectory":"Resource Directory","nav.marketplace":"Marketplace"},es:{"nav.dashboard":"Panel","nav.preArrival":"Antes de llegar","nav.campusNavigation":"Navegaci\xf3n del campus","nav.academicIntegration":"Integraci\xf3n acad\xe9mica","nav.socialNetworking":"Red social","nav.resourceDirectory":"Directorio de recursos","nav.marketplace":"Mercado"}},i=(0,a.createContext)(null);function o({children:e}){let[t,r]=(0,a.useState)("en");return n.jsx(i.Provider,{value:{lang:t,setLang:r,t:e=>s[t][e]??s.en[e]??e},children:e})}},74165:(e,t,r)=>{"use strict";r.d(t,{B:()=>i,r:()=>o});var n=r(10326),a=r(17577);let s=(0,a.createContext)(void 0);function i({children:e}){let[t,r]=(0,a.useState)([]);return n.jsx(s.Provider,{value:{items:t,addToCart:e=>{r(t=>t.find(t=>t.product.id===e.id)?t.map(t=>t.product.id===e.id?{...t,quantity:t.quantity+1}:t):[...t,{product:e,quantity:1}])},removeFromCart:e=>{r(t=>t.filter(t=>t.product.id!==e))},clearCart:()=>r([])},children:e})}function o(){let e=(0,a.useContext)(s);if(!e)throw Error("useMarketplaceCart must be used within MarketplaceCartProvider");return e}},82746:(e,t,r)=>{"use strict";r.d(t,{MarketplaceCartLayoutClient:()=>s});var n=r(10326),a=r(74165);function s({children:e}){return n.jsx(a.B,{children:e})}},10703:(e,t,r)=>{"use strict";r.d(t,{MarketplaceChat:()=>i});var n=r(10326),a=r(17577),s=r(21021);function i({conversationId:e,currentUserId:t}){let[r,i]=(0,a.useState)([]),[o,l]=(0,a.useState)(""),[d,c]=(0,a.useState)(!1),[u,p]=(0,a.useState)(null),m=(0,a.useRef)(null),f=async t=>{if(t.preventDefault(),o.trim()){c(!0),p(null);try{let t=await fetch(`/api/marketplace/conversations/${e}/messages`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:o})});if(!t.ok){let e=await t.text();throw Error(e||"Failed to send message")}l("")}catch(e){console.error(e),p(e.message||"Something went wrong")}finally{c(!1)}}};return(0,n.jsxs)(s.Z,{className:"flex h-[380px] flex-col bg-white/95 text-slate-900",children:[n.jsx("div",{className:"mb-2 text-[11px] text-slate-600",children:"Use this chat to coordinate pickup location (e.g., MTCC, library) and confirm the item before payment in person."}),(0,n.jsxs)("div",{className:"flex-1 space-y-2 overflow-y-auto rounded-lg bg-slate-50 p-2 text-xs",children:[0===r.length?n.jsx("p",{className:"text-[11px] text-slate-400",children:"No messages yet. Start the conversation!"}):r.map(e=>{let r=e.sender.id===t;return n.jsx("div",{className:`flex ${r?"justify-end":"justify-start"}`,children:(0,n.jsxs)("div",{className:`max-w-[75%] rounded-xl px-3 py-1.5 text-[11px] ${r?"bg-red-600 text-white":"bg-white text-slate-900 ring-1 ring-slate-200"}`,children:[!r&&n.jsx("p",{className:"text-[10px] font-semibold text-slate-700",children:e.sender.fullName||"Student"}),n.jsx("p",{children:e.content}),n.jsx("p",{className:`mt-0.5 text-[9px] ${r?"text-red-100/80":"text-slate-400"}`,children:new Date(e.createdAt).toLocaleString()})]})},e.id)}),n.jsx("div",{ref:m})]}),u&&n.jsx("p",{className:"mt-1 text-[10px] text-red-600",children:u}),(0,n.jsxs)("form",{onSubmit:f,className:"mt-2 flex gap-2 border-t border-slate-200 pt-2",children:[n.jsx("input",{value:o,onChange:e=>l(e.target.value),className:"flex-1 rounded-lg border border-slate-300 px-2 py-1 text-xs focus:border-red-500 focus:outline-none focus:ring-1 focus:ring-red-500",placeholder:"Type a message…"}),n.jsx("button",{type:"submit",disabled:d,className:"rounded-lg bg-red-600 px-3 py-1.5 text-[11px] font-semibold text-white hover:bg-red-500 disabled:opacity-60",children:"Send"})]})]})}},21021:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var n=r(10326),a=r(41135);function s({children:e,className:t}){return n.jsx("div",{className:(0,a.W)("rounded-2xl border border-slate-500/90 bg-slate-200/80 p-4 shadow-lg shadow-black/40",t),children:e})}},71227:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>c,metadata:()=>d});var n=r(19510),a=r(77366),s=r.n(a);r(67272);var i=r(68570);let o=(0,i.createProxy)(String.raw`C:\Users\vyoml\iit-international-student-dashboard-main\components\i18n\I18nProvider.tsx#I18nProvider`);(0,i.createProxy)(String.raw`C:\Users\vyoml\iit-international-student-dashboard-main\components\i18n\I18nProvider.tsx#useI18n`);let l=(0,i.createProxy)(String.raw`C:\Users\vyoml\iit-international-student-dashboard-main\app\api\chat\IStudentsChatWidget.tsx#IStudentsChatWidget`),d={title:"IIT International Student Onboarding Dashboard",description:"Modern dashboard to support international students transitioning to Illinois Institute of Technology (IIT)."};function c({children:e}){return n.jsx("html",{lang:"en",suppressHydrationWarning:!0,children:(0,n.jsxs)("body",{className:s().className,children:[n.jsx(o,{children:e}),n.jsx(l,{})]})})}},9149:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>c,dynamic:()=>d});var n=r(19510),a=r(58585),s=r(83493),i=r(90455),o=r(66601);let l=(0,r(68570).createProxy)(String.raw`C:\Users\vyoml\iit-international-student-dashboard-main\components\marketplace\MarketplaceChat.tsx#MarketplaceChat`),d="force-dynamic";async function c({params:e}){let t=await (0,i.V)();t||(0,a.redirect)("/login");let r=await s._.marketplaceConversation.findUnique({where:{id:e.id},include:{order:{include:{product:!0}},buyer:!0,seller:!0}});r||(0,a.redirect)("/marketplace/my"),r.buyerId!==t.id&&r.sellerId!==t.id&&(0,a.redirect)("/marketplace/my");let d=r.buyerId===t.id?r.seller:r.buyer;return(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)(o.Z,{className:"bg-white/95 text-slate-900",children:[(0,n.jsxs)("h1",{className:"text-sm font-semibold",children:["Chat about: ",r.order.product.title]}),(0,n.jsxs)("p",{className:"text-[11px] text-slate-600",children:["You are chatting with"," ",n.jsx("span",{className:"font-semibold",children:d.fullName||"IIT student"}),"."]})]}),n.jsx(l,{conversationId:r.id,currentUserId:t.id})]})}},83794:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});var n=r(19510);let a=(0,r(68570).createProxy)(String.raw`C:\Users\vyoml\iit-international-student-dashboard-main\components\marketplace\MarketplaceCartLayoutClient.tsx#MarketplaceCartLayoutClient`);function s({children:e}){return n.jsx(a,{children:e})}},66601:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var n=r(19510),a=r(55761);function s({children:e,className:t}){return n.jsx("div",{className:(0,a.W)("rounded-2xl border border-slate-500/90 bg-slate-200/80 p-4 shadow-lg shadow-black/40",t),children:e})}},90455:(e,t,r)=>{"use strict";async function n(){try{let e=await fetch(`${process.env.NEXT_PUBLIC_APP_URL??""}/api/auth/me`,{cache:"no-store"});if(!e.ok)return null;return(await e.json()).student??null}catch(e){return console.error("getCurrentStudent error:",e),null}}r.d(t,{V:()=>n})},83493:(e,t,r)=>{"use strict";r.d(t,{_:()=>a});let n=require("@prisma/client"),a=globalThis.prisma??new n.PrismaClient({log:["error","warn"]})},58585:(e,t,r)=>{"use strict";var n=r(61085);r.o(n,"notFound")&&r.d(t,{notFound:function(){return n.notFound}}),r.o(n,"redirect")&&r.d(t,{redirect:function(){return n.redirect}})},61085:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{ReadonlyURLSearchParams:function(){return i},RedirectType:function(){return n.RedirectType},notFound:function(){return a.notFound},permanentRedirect:function(){return n.permanentRedirect},redirect:function(){return n.redirect}});let n=r(83953),a=r(16399);class s extends Error{constructor(){super("Method unavailable on `ReadonlyURLSearchParams`. Read more: https://nextjs.org/docs/app/api-reference/functions/use-search-params#updating-searchparams")}}class i extends URLSearchParams{append(){throw new s}delete(){throw new s}set(){throw new s}sort(){throw new s}}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},16399:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{isNotFoundError:function(){return a},notFound:function(){return n}});let r="NEXT_NOT_FOUND";function n(){let e=Error(r);throw e.digest=r,e}function a(e){return"object"==typeof e&&null!==e&&"digest"in e&&e.digest===r}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},8586:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"RedirectStatusCode",{enumerable:!0,get:function(){return r}}),function(e){e[e.SeeOther=303]="SeeOther",e[e.TemporaryRedirect=307]="TemporaryRedirect",e[e.PermanentRedirect=308]="PermanentRedirect"}(r||(r={})),("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},83953:(e,t,r)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{RedirectType:function(){return n},getRedirectError:function(){return l},getRedirectStatusCodeFromError:function(){return f},getRedirectTypeFromError:function(){return m},getURLFromRedirectError:function(){return p},isRedirectError:function(){return u},permanentRedirect:function(){return c},redirect:function(){return d}});let a=r(54580),s=r(72934),i=r(8586),o="NEXT_REDIRECT";function l(e,t,r){void 0===r&&(r=i.RedirectStatusCode.TemporaryRedirect);let n=Error(o);n.digest=o+";"+t+";"+e+";"+r+";";let s=a.requestAsyncStorage.getStore();return s&&(n.mutableCookies=s.mutableCookies),n}function d(e,t){void 0===t&&(t="replace");let r=s.actionAsyncStorage.getStore();throw l(e,t,(null==r?void 0:r.isAction)?i.RedirectStatusCode.SeeOther:i.RedirectStatusCode.TemporaryRedirect)}function c(e,t){void 0===t&&(t="replace");let r=s.actionAsyncStorage.getStore();throw l(e,t,(null==r?void 0:r.isAction)?i.RedirectStatusCode.SeeOther:i.RedirectStatusCode.PermanentRedirect)}function u(e){if("object"!=typeof e||null===e||!("digest"in e)||"string"!=typeof e.digest)return!1;let[t,r,n,a]=e.digest.split(";",4),s=Number(a);return t===o&&("replace"===r||"push"===r)&&"string"==typeof n&&!isNaN(s)&&s in i.RedirectStatusCode}function p(e){return u(e)?e.digest.split(";",3)[2]:null}function m(e){if(!u(e))throw Error("Not a redirect error");return e.digest.split(";",2)[1]}function f(e){if(!u(e))throw Error("Not a redirect error");return Number(e.digest.split(";",4)[3])}(function(e){e.push="push",e.replace="replace"})(n||(n={})),("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},67272:()=>{},55761:(e,t,r)=>{"use strict";function n(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=function e(t){var r,n,a="";if("string"==typeof t||"number"==typeof t)a+=t;else if("object"==typeof t){if(Array.isArray(t)){var s=t.length;for(r=0;r<s;r++)t[r]&&(n=e(t[r]))&&(a&&(a+=" "),a+=n)}else for(n in t)t[n]&&(a&&(a+=" "),a+=n)}return a}(e))&&(n&&(n+=" "),n+=t);return n}r.d(t,{W:()=>n})}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[9276,7261],()=>r(74368));module.exports=n})();