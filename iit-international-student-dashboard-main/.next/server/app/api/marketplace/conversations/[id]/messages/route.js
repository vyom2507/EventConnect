"use strict";(()=>{var e={};e.id=6408,e.ids=[6408],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},88923:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>v,patchFetch:()=>h,requestAsyncStorage:()=>m,routeModule:()=>p,serverHooks:()=>w,staticGenerationAsyncStorage:()=>f});var n={};r.r(n),r.d(n,{GET:()=>l,POST:()=>c});var s=r(49303),a=r(88716),i=r(60670),o=r(87070),u=r(83493),d=r(90455);async function l(e,{params:t}){let r=await (0,d.V)();if(!r)return new o.NextResponse("Unauthorized",{status:401});let n=await u._.marketplaceConversation.findUnique({where:{id:t.id}});if(!n)return new o.NextResponse("Not found",{status:404});if(n.buyerId!==r.id&&n.sellerId!==r.id)return new o.NextResponse("Forbidden",{status:403});let s=await u._.marketplaceMessage.findMany({where:{conversationId:t.id},include:{sender:{select:{id:!0,fullName:!0}}},orderBy:{createdAt:"asc"}});return o.NextResponse.json({messages:s})}async function c(e,{params:t}){let r=await (0,d.V)();if(!r)return new o.NextResponse("Unauthorized",{status:401});let n=await u._.marketplaceConversation.findUnique({where:{id:t.id}});if(!n)return new o.NextResponse("Not found",{status:404});if(n.buyerId!==r.id&&n.sellerId!==r.id)return new o.NextResponse("Forbidden",{status:403});let{content:s}=await e.json();if(!s||!s.trim())return new o.NextResponse("Message content is required",{status:400});let a=await u._.marketplaceMessage.create({data:{conversationId:t.id,senderId:r.id,content:s.trim()},include:{sender:{select:{id:!0,fullName:!0}}}});return o.NextResponse.json({message:a},{status:201})}let p=new s.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/marketplace/conversations/[id]/messages/route",pathname:"/api/marketplace/conversations/[id]/messages",filename:"route",bundlePath:"app/api/marketplace/conversations/[id]/messages/route"},resolvedPagePath:"C:\\Users\\vyoml\\iit-international-student-dashboard-main\\app\\api\\marketplace\\conversations\\[id]\\messages\\route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:m,staticGenerationAsyncStorage:f,serverHooks:w}=p,v="/api/marketplace/conversations/[id]/messages/route";function h(){return(0,i.patchFetch)({serverHooks:w,staticGenerationAsyncStorage:f})}},90455:(e,t,r)=>{r.d(t,{V:()=>n});async function n(){try{let e=await fetch(`${process.env.NEXT_PUBLIC_APP_URL??""}/api/auth/me`,{cache:"no-store"});if(!e.ok)return null;return(await e.json()).student??null}catch(e){return console.error("getCurrentStudent error:",e),null}}},83493:(e,t,r)=>{r.d(t,{_:()=>s});let n=require("@prisma/client"),s=globalThis.prisma??new n.PrismaClient({log:["error","warn"]})}};var t=require("../../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[9276,5972],()=>r(88923));module.exports=n})();