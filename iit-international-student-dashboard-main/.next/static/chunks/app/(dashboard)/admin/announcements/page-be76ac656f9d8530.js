(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[499],{5907:function(e,t,s){Promise.resolve().then(s.bind(s,4578))},4578:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return l}});var a=s(7437),n=s(2265);function l(){let[e,t]=(0,n.useState)([]),[s,l]=(0,n.useState)(""),[r,o]=(0,n.useState)(""),[d,i]=(0,n.useState)(!0),[c,u]=(0,n.useState)(!1),[x,m]=(0,n.useState)(null),h=async()=>{i(!0);try{let e=await fetch("/api/admin/announcements"),s=await e.json();if(!e.ok){m(s.error||"Failed to load announcements.");return}t(s.announcements||[])}catch(e){console.error(e),m("Failed to load announcements.")}finally{i(!1)}};(0,n.useEffect)(()=>{h()},[]);let p=async e=>{if(e.preventDefault(),m(null),!s||!r){m("Title and body are required.");return}u(!0);try{let e=await fetch("/api/admin/announcements",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:s,body:r})}),t=await e.json();if(!e.ok)throw Error(t.error||"Failed to create announcement.");l(""),o(""),await h()}catch(e){m(e.message||"Failed to create announcement.")}finally{u(!1)}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.25em] text-red-300",children:"Admin \xb7 Announcements"}),(0,a.jsx)("h1",{className:"mt-1 text-xl font-semibold text-slate-50",children:"Broadcast updates to IIT international students"}),(0,a.jsx)("p",{className:"text-xs text-slate-400",children:"Post important notices about orientation, immigration advising, deadlines, and campus events. These can be surfaced on the dashboard later."})]}),(0,a.jsxs)("form",{onSubmit:p,className:"space-y-3 rounded-2xl bg-slate-950/80 p-4 ring-1 ring-slate-800",children:[x&&(0,a.jsx)("div",{className:"rounded-lg border border-red-500/60 bg-red-950/60 px-3 py-2 text-xs text-red-100",children:x}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("label",{className:"block text-[11px] font-semibold text-slate-200",children:"Title"}),(0,a.jsx)("input",{className:"w-full rounded-lg border border-slate-700 bg-slate-950 px-3 py-2 text-sm text-slate-100 outline-none focus:border-red-500 focus:ring-1 focus:ring-red-500",value:s,onChange:e=>l(e.target.value),placeholder:"Orientation schedule updated"})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("label",{className:"block text-[11px] font-semibold text-slate-200",children:"Message"}),(0,a.jsx)("textarea",{className:"min-h-[90px] w-full rounded-lg border border-slate-700 bg-slate-950 px-3 py-2 text-sm text-slate-100 outline-none focus:border-red-500 focus:ring-1 focus:ring-red-500",value:r,onChange:e=>o(e.target.value),placeholder:"Share details about time, location, and what students should bring..."})]}),(0,a.jsx)("button",{type:"submit",disabled:c,className:"inline-flex items-center justify-center rounded-lg bg-red-600 px-4 py-2 text-sm font-semibold text-white shadow-sm shadow-red-900/40 hover:bg-red-500 disabled:cursor-not-allowed disabled:bg-red-300",children:c?"Posting…":"Post announcement"})]}),(0,a.jsxs)("section",{className:"space-y-3",children:[(0,a.jsx)("h2",{className:"text-sm font-semibold text-slate-100",children:"Recent announcements"}),d?(0,a.jsx)("p",{className:"text-xs text-slate-400",children:"Loading…"}):0===e.length?(0,a.jsx)("p",{className:"text-xs text-slate-400",children:"No announcements yet. Create the first one above."}):(0,a.jsx)("div",{className:"space-y-2",children:e.map(e=>(0,a.jsxs)("div",{className:"rounded-xl bg-slate-950/80 p-3 text-xs ring-1 ring-slate-800",children:[(0,a.jsx)("p",{className:"text-[11px] font-semibold text-slate-50",children:e.title}),(0,a.jsx)("p",{className:"mt-1 text-[11px] text-slate-200",children:e.body}),(0,a.jsxs)("p",{className:"mt-2 text-[10px] text-slate-500",children:["Posted by ",e.createdBy.fullName," <",e.createdBy.email,"> \xb7"," ",new Date(e.createdAt).toLocaleString()]})]},e.id))})]})]})}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=5907)}),_N_E=e.O()}]);