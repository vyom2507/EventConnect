(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[818],{2875:function(e,t,r){Promise.resolve().then(r.bind(r,861))},861:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return v}});var n=r(7437),s=r(2265),a=r(9376),l=r(9178),i=r(2660),o=r(2720),c=r(9205);let u=(0,c.Z)("CloudUpload",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]]),d=(0,c.Z)("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);var f=r(7648),h=r(257);let x=["Textbooks","Furniture & Room","Electronics & Accessories","Kitchen","Clothing","Other"],p=["IIT Main Campus (Mies)","Downtown Campus","Online / Remote","Other"],m=h.env.NEXT_PUBLIC_CLOUDINARY_CLOUD_NAME,g=h.env.NEXT_PUBLIC_CLOUDINARY_UPLOAD_PRESET;function v(){let e=(0,a.useRouter)(),[t,r]=(0,s.useState)(""),[c,h]=(0,s.useState)(""),[v,b]=(0,s.useState)(""),[y,j]=(0,s.useState)("Textbooks"),[w,N]=(0,s.useState)("Like New"),[k,C]=(0,s.useState)("IIT Main Campus (Mies)"),[T,L]=(0,s.useState)(""),[_,E]=(0,s.useState)(null),[I,A]=(0,s.useState)(!1),[P,S]=(0,s.useState)(!1),O=async e=>{var t,r;E(null);let n=null===(t=e.target.files)||void 0===t?void 0:t[0];if(n){if(!m||!g){E("Cloudinary is not configured. Please set NEXT_PUBLIC_CLOUDINARY_CLOUD_NAME and NEXT_PUBLIC_CLOUDINARY_UPLOAD_PRESET in .env.local.");return}S(!0);try{let e=new FormData;e.append("file",n),e.append("upload_preset",g);let t=await fetch("https://api.cloudinary.com/v1_1/".concat(m,"/image/upload"),{method:"POST",body:e});if(!t.ok){let e=await t.json().catch(()=>({}));throw Error((null===(r=e.error)||void 0===r?void 0:r.message)||"Image upload failed. Try a smaller file.")}let s=await t.json();if(!s.secure_url)throw Error("No secure_url returned from Cloudinary.");L(s.secure_url)}catch(e){console.error("Upload error:",e),E(e.message||"Failed to upload image. Please try a smaller file.")}finally{S(!1)}}},U=async r=>{if(r.preventDefault(),E(null),!t||!c||!v){E("Title, description, and price are required.");return}if(P){E("Please wait for the image upload to finish.");return}A(!0);try{let r=await fetch("/api/marketplace/products",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:t,description:c,price:v,category:y,condition:w,campus:k,imageUrl:T})}),n=await r.json();if(!r.ok)throw Error(n.error||"Failed to create listing");e.push("/marketplace")}catch(e){E(e.message||"Something went wrong")}finally{A(!1)}};return(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)(f.default,{href:"/marketplace",className:"inline-flex items-center gap-1 text-[11px] text-slate-300 hover:text-slate-100",children:[(0,n.jsx)(i.Z,{className:"h-3 w-3"}),"Back to marketplace"]}),(0,n.jsxs)(l.Z,{children:[(0,n.jsxs)("header",{className:"mb-3 flex items-center gap-2",children:[(0,n.jsx)("span",{className:"inline-flex h-7 w-7 items-center justify-center rounded-full bg-red-600/20 text-red-300 ring-1 ring-red-500/40",children:(0,n.jsx)(o.Z,{className:"h-4 w-4"})}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-sm font-semibold text-slate-50",children:"List an item for IIT students"}),(0,n.jsx)("p",{className:"text-xs text-slate-400",children:"Share a used textbook, furniture, or other items with the IIT international student community."})]})]}),(0,n.jsxs)("form",{onSubmit:U,className:"space-y-3 text-xs",children:[(0,n.jsxs)("div",{className:"grid gap-3 md:grid-cols-2",children:[(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-[11px] text-slate-200",children:"Item title *"}),(0,n.jsx)("input",{type:"text",className:"mt-1 w-full rounded-lg border border-slate-700 bg-slate-950 px-3 py-2 text-xs text-slate-100 focus:border-red-500 focus:outline-none focus:ring-1 focus:ring-red-500",placeholder:"e.g. Intro to Programming Textbook, Twin Bed Frame",value:t,onChange:e=>r(e.target.value)})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-[11px] text-slate-200",children:"Price (USD) *"}),(0,n.jsx)("input",{type:"number",min:"0",step:"0.01",className:"mt-1 w-full rounded-lg border border-slate-700 bg-slate-950 px-3 py-2 text-xs text-slate-100 focus:border-red-500 focus:outline-none focus:ring-1 focus:ring-red-500",placeholder:"e.g. 25.00",value:v,onChange:e=>b(e.target.value)})]}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-[11px] text-slate-200",children:"Category"}),(0,n.jsx)("select",{className:"mt-1 w-full rounded-lg border border-slate-700 bg-slate-950 px-2 py-2 text-xs text-slate-100 focus:border-red-500 focus:outline-none focus:ring-1 focus:ring-red-500",value:y,onChange:e=>j(e.target.value),children:x.map(e=>(0,n.jsx)("option",{value:e,children:e},e))})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-[11px] text-slate-200",children:"Condition"}),(0,n.jsxs)("select",{className:"mt-1 w-full rounded-lg border border-slate-700 bg-slate-950 px-2 py-2 text-xs text-slate-100 focus:border-red-500 focus:outline-none focus:ring-1 focus:ring-red-500",value:w,onChange:e=>N(e.target.value),children:[(0,n.jsx)("option",{value:"New",children:"New"}),(0,n.jsx)("option",{value:"Like New",children:"Like New"}),(0,n.jsx)("option",{value:"Very Good",children:"Very Good"}),(0,n.jsx)("option",{value:"Good",children:"Good"}),(0,n.jsx)("option",{value:"Fair",children:"Fair"})]})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-[11px] text-slate-200",children:"Campus / pickup location"}),(0,n.jsx)("select",{className:"mt-1 w-full rounded-lg border border-slate-700 bg-slate-950 px-2 py-2 text-xs text-slate-100 focus:border-red-500 focus:outline-none focus:ring-1 focus:ring-red-500",value:k,onChange:e=>C(e.target.value),children:p.map(e=>(0,n.jsx)("option",{value:e,children:e},e))})]})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-[11px] text-slate-200",children:"Description *"}),(0,n.jsx)("textarea",{className:"mt-1 min-h-[120px] w-full rounded-lg border border-slate-700 bg-slate-950 px-3 py-2 text-xs text-slate-100 focus:border-red-500 focus:outline-none focus:ring-1 focus:ring-red-500",placeholder:"Give details about the item, its condition, whatâ€™s included, and how you prefer to meet on campus.",value:c,onChange:e=>h(e.target.value)})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-[11px] text-slate-200",children:"Item photo (optional)"}),(0,n.jsxs)("div",{className:"mt-1 flex items-center gap-2",children:[(0,n.jsxs)("label",{className:"inline-flex cursor-pointer items-center gap-2 rounded-lg bg-slate-900 px-3 py-2 text-[11px] font-medium text-slate-100 ring-1 ring-slate-700 hover:bg-slate-800",children:[(0,n.jsx)(u,{className:"h-4 w-4"}),(0,n.jsx)("span",{children:P?"Uploading...":"Choose image file"}),(0,n.jsx)("input",{type:"file",accept:"image/*",className:"hidden",onChange:O,disabled:P})]}),T&&(0,n.jsx)("span",{className:"inline-flex h-8 w-8 items-center justify-center overflow-hidden rounded-lg bg-slate-900 ring-1 ring-slate-700",children:(0,n.jsx)("img",{src:T,alt:"Preview",className:"h-full w-full object-cover"})}),!T&&!P&&(0,n.jsx)("span",{className:"inline-flex h-8 w-8 items-center justify-center rounded-lg bg-slate-900 text-slate-400 ring-1 ring-slate-700",children:(0,n.jsx)(d,{className:"h-4 w-4"})})]}),(0,n.jsx)("p",{className:"mt-1 text-[9px] text-slate-500",children:"Images are uploaded to Cloudinary using an unsigned upload preset and linked to this listing via a public URL."})]})]})]}),_&&(0,n.jsxs)("p",{className:"text-[10px] text-red-300",children:["Error: ",_]}),(0,n.jsxs)("div",{className:"flex items-center justify-between pt-2 text-[10px]",children:[(0,n.jsx)("p",{className:"text-slate-500",children:"By listing an item, you agree to meet safely on campus and follow IIT/istudentshub guidelines."}),(0,n.jsx)("button",{type:"submit",disabled:I||P,className:"inline-flex items-center justify-center rounded-lg bg-red-600 px-4 py-2 text-[11px] font-semibold text-white shadow-sm shadow-red-900/40 hover:bg-red-500 disabled:cursor-not-allowed disabled:bg-red-900",children:I?"Creating listing...":P?"Uploading image...":"Create listing"})]})]})]})]})}},9178:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});var n=r(7437),s=r(1994);function a(e){let{children:t,className:r}=e;return(0,n.jsx)("div",{className:(0,s.W)("rounded-2xl border border-slate-500/90 bg-slate-200/80 p-4 shadow-lg shadow-black/40",r),children:t})}},9205:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});var n=r(2265);let s=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),a=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,n.forwardRef)((e,t)=>{let{color:r="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:c="",children:u,iconNode:d,...f}=e;return(0,n.createElement)("svg",{ref:t,...l,width:s,height:s,stroke:r,strokeWidth:o?24*Number(i)/Number(s):i,className:a("lucide",c),...f},[...d.map(e=>{let[t,r]=e;return(0,n.createElement)(t,r)}),...Array.isArray(u)?u:[u]])}),o=(e,t)=>{let r=(0,n.forwardRef)((r,l)=>{let{className:o,...c}=r;return(0,n.createElement)(i,{ref:l,iconNode:t,className:a("lucide-".concat(s(e)),o),...c})});return r.displayName="".concat(e),r}},2660:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(9205).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},2720:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(9205).Z)("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]])},7648:function(e,t,r){"use strict";r.d(t,{default:function(){return s.a}});var n=r(2972),s=r.n(n)},9376:function(e,t,r){"use strict";var n=r(5475);r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}})},257:function(e,t,r){"use strict";var n,s;e.exports=(null==(n=r.g.process)?void 0:n.env)&&"object"==typeof(null==(s=r.g.process)?void 0:s.env)?r.g.process:r(4227)},4227:function(e){!function(){var t={229:function(e){var t,r,n,s=e.exports={};function a(){throw Error("setTimeout has not been defined")}function l(){throw Error("clearTimeout has not been defined")}function i(e){if(t===setTimeout)return setTimeout(e,0);if((t===a||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:a}catch(e){t=a}try{r="function"==typeof clearTimeout?clearTimeout:l}catch(e){r=l}}();var o=[],c=!1,u=-1;function d(){c&&n&&(c=!1,n.length?o=n.concat(o):u=-1,o.length&&f())}function f(){if(!c){var e=i(d);c=!0;for(var t=o.length;t;){for(n=o,o=[];++u<t;)n&&n[u].run();u=-1,t=o.length}n=null,c=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===l||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function x(){}s.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];o.push(new h(e,t)),1!==o.length||c||i(f)},h.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=x,s.addListener=x,s.once=x,s.off=x,s.removeListener=x,s.removeAllListeners=x,s.emit=x,s.prependListener=x,s.prependOnceListener=x,s.listeners=function(e){return[]},s.binding=function(e){throw Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw Error("process.chdir is not supported")},s.umask=function(){return 0}}},r={};function n(e){var s=r[e];if(void 0!==s)return s.exports;var a=r[e]={exports:{}},l=!0;try{t[e](a,a.exports,n),l=!1}finally{l&&delete r[e]}return a.exports}n.ab="//";var s=n(229);e.exports=s}()},1994:function(e,t,r){"use strict";function n(){for(var e,t,r=0,n="",s=arguments.length;r<s;r++)(e=arguments[r])&&(t=function e(t){var r,n,s="";if("string"==typeof t||"number"==typeof t)s+=t;else if("object"==typeof t){if(Array.isArray(t)){var a=t.length;for(r=0;r<a;r++)t[r]&&(n=e(t[r]))&&(s&&(s+=" "),s+=n)}else for(n in t)t[n]&&(s&&(s+=" "),s+=n)}return s}(e))&&(n&&(n+=" "),n+=t);return n}r.d(t,{W:function(){return n}}),t.Z=n}},function(e){e.O(0,[972,971,117,744],function(){return e(e.s=2875)}),_N_E=e.O()}]);